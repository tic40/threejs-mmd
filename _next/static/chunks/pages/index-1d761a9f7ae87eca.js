(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(1906)}])},1906:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return D}});var r,a,o,i,c,s,u,d,l,p,m,h,f,w,v,g,x=n(4051),y=n.n(x),b=n(5893),k=n(7294),_=n(9477),j=n(2274),C=n(5414),P=n.n(C),M=n(9008),S=n.n(M),E=function(e){var t=e.title,n=e.description;return(0,b.jsxs)(S(),{children:[(0,b.jsx)("title",{children:t}),(0,b.jsx)("meta",{property:"description",content:n}),(0,b.jsx)("meta",{property:"og:title",content:t}),(0,b.jsx)("meta",{property:"og:description",content:n}),(0,b.jsx)("meta",{property:"og:image",content:"https://avatars.githubusercontent.com/u/739402?v=4?s=400"}),(0,b.jsx)("meta",{name:"twitter:card",content:"summary"}),(0,b.jsx)("link",{rel:"icon",href:"".concat("/threejs-mmd/","/favicon.ico")})]})},N=n(2125),F=n(410),A=[{name:"lat_miku",path:"./models/lat_miku/Lat\u5f0f\u30df\u30afVer2.31_White.pmd",height:1.58,emissiveMag:1.5},{name:"alicia",path:"./models/alicia/mmd/Alicia_solid.pmx",height:1.48,emissiveMag:.1}],O=[{name:"bonyari",path:"./motions/bonyari.vmd"},{name:"gokigen",path:"./motions/gokigen.vmd"},{name:"atamawokaku",path:"./motions/atamawokaku.vmd"},{name:"nekomimi_switch",path:"./motions/nekomimi_lat.vmd"},{name:"schrodingeiger_no_koneko",path:"./motions/Schrodingeiger_no_Koneko1.vmd"}],z=n(9365);function R(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(u){return void n(u)}c.done?t(s):Promise.resolve(s).then(r,a)}function T(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){R(o,r,a,i,c,"next",e)}function c(e){R(o,r,a,i,c,"throw",e)}i(void 0)}))}}var D=function(){var e=function(){for(var e;null===(e=S.current)||void 0===e?void 0:e.firstChild;)S.current.removeChild(S.current.firstChild)},t=function(e){return j.d9(e)},n=function(){return A[v]},x=function(){return O[g]},C=function(){var e,t;o=window.innerWidth,i=window.innerHeight,a={},v=0,t=O.length,g=Math.floor(Math.random()*t),s=new _.xsS,u=new _.SUY,d=new N._,l=new F.k,(c=new _.CP7).setPixelRatio(window.devicePixelRatio),c.setSize(o,i),c.setClearColor(16777215,1),c.shadowMap.enabled=!0,null===(e=S.current)||void 0===e||e.appendChild(c.domElement),p=new _.cPb(45,o/i,.1,100),s.add(new _.Mig(16777215,.6)),(h=new _.Ox3(16769721,.4)).position.set(2,4,2),h.castShadow=!0,s.add(h),(m=new _.Kj0(new _._12(10,10,1,1),new _.Tn7({opacity:.2}))).rotation.x=-Math.PI/2,m.receiveShadow=!0,s.add(m),s.add(new _.VLJ(10,20,0,10066329)),s.add(new _.y8_(10)),(f=new z.z(p,c.domElement)).enableDamping=!0},M=function(){var e=function(){d.update(u.getDelta()),f.update(),c.render(s,p),r=requestAnimationFrame(e)};e()},S=(0,k.useRef)(null),R=(0,k.useState)(!1),D=R[0],H=R[1];function K(){return L.apply(this,arguments)}function L(){return(L=T(y().mark((function t(){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return H(!0),e(),C(),t.next=5,P()();case 5:return t.next=7,V();case 7:return t.next=9,X();case 9:M(),H(!1);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function V(){return W.apply(this,arguments)}function W(){return(W=T(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){var n=A[v];if(a[n.name])return e();l.load(n.path,(function(t){t.castShadow=!0;var r=(new _.ZzF).setFromObject(t);t.scale.multiplyScalar(n.height/r.max.y),t.material.forEach((function(e){e.emissive.multiplyScalar(n.emissiveMag)})),a[n.name]=t,e()}),(function(e){return console.info(e.loaded/e.total*100+"% loaded")}),(function(e){return t(e)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(){return q.apply(this,arguments)}function q(){return(q=T(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var o=n(),i=x();w=t(a[o.name]),l.loadAnimation(i.path,w,(function(t){if(d.meshes.length)return e();try{d.add(w,{animation:t,physics:!0})}catch(n){console.error(n),r(n)}s.add(w),f.target.set(0,o.height/2,0),f.object.position.set(0,.55*o.height,1.9*o.height),e()}),(function(e){return console.info(e.loaded/e.total*100+"% loaded")}),(function(e){return r(e)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(){return(G=T(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:v=(v+1)%A.length,J();case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(){return(I=T(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g=(g+1)%O.length,J();case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(){return U.apply(this,arguments)}function U(){return(U=T(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return H(!0),d.remove(w),s.remove(w),cancelAnimationFrame(r),e.prev=4,e.next=7,V();case 7:return e.next=9,X();case 9:e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(4),K(),e.abrupt("return");case 15:M(),H(!1);case 17:case"end":return e.stop()}}),e,null,[[4,11]])})))).apply(this,arguments)}return(0,k.useEffect)((function(){K()}),[]),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(E,{title:"tic40/threejs-mmd",description:"tic40/threejs-mmd"}),(0,b.jsx)("div",{className:"absolute top-1/2 left-1/2 animate-ping h-5 w-5 bg-gray-600 rounded-full",role:"status",style:{display:D?"block":"none"}}),(0,b.jsx)("button",{onClick:function(){return G.apply(this,arguments)},className:"absolute top-2 left-2 bg-transparent text-gray-700 py-1 px-1 border border-gray-500 rounded",disabled:D,children:"Model >>"}),(0,b.jsx)("button",{onClick:function(){return I.apply(this,arguments)},className:"absolute top-2 left-24 bg-transparent text-gray-700 py-1 px-1 border border-gray-500 rounded",disabled:D,children:"Motion >>"}),(0,b.jsx)("a",{className:"absolute bottom-2 left-2 bg-transparent text-gray-700 py-1 px-1 noborder rounded",href:"https://github.com/tic40/threejs-mmd",target:"_blank",rel:"noreferrer",children:"GitHub"}),(0,b.jsx)("div",{ref:S})]})}},1756:function(){}},function(e){e.O(0,[737,34,472,774,888,179],(function(){return t=8312,e(e.s=t);var t}));var t=e.O();_N_E=t}]);