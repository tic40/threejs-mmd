(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{7084:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(5134)}])},5134:function(e,t,n){"use strict";let a,o,i,r,s,l,d,c,m,h,u,p,g,w,f,y;n.r(t),n.d(t,{default:function(){return O}});var b=n(2676),x=n(5271),v=n(904),_=n(9233),k=n(1980),j=n.n(k),C=n(5742),M=n.n(C),S=e=>{let{title:t,description:n}=e;return(0,b.jsxs)(M(),{children:[(0,b.jsx)("title",{children:t}),(0,b.jsx)("meta",{property:"description",content:n}),(0,b.jsx)("meta",{property:"og:title",content:t}),(0,b.jsx)("meta",{property:"og:description",content:n}),(0,b.jsx)("meta",{property:"og:image",content:"https://avatars.githubusercontent.com/u/739402?v=4?s=400"}),(0,b.jsx)("meta",{name:"twitter:card",content:"summary"}),(0,b.jsx)("link",{rel:"icon",href:"".concat("/threejs-mmd/","/favicon.ico")})]})},E=n(3166),N=n(8928);let P=[{name:"lat_miku",path:"./models/lat_miku/Lat式ミクVer2.31_White.pmd",height:1.58,emissiveMag:0},{name:"alicia",path:"./models/alicia/Alicia_solid.pmx",height:1.48,emissiveMag:-1}],F=[{name:"bonyari",path:"./motions/bonyari.vmd"},{name:"gokigen",path:"./motions/gokigen.vmd"},{name:"atamawokaku",path:"./motions/atamawokaku.vmd"},{name:"nekomimi_switch",path:"./motions/nekomimi_lat.vmd"},{name:"schrodingeiger_no_koneko",path:"./motions/Schrodingeiger_no_Koneko1.vmd"}];var A=n(911),O=()=>{let e=(0,x.useRef)(null),[t,n]=(0,x.useState)(!1);async function k(){n(!0),function(){for(var t;null===(t=e.current)||void 0===t?void 0:t.firstChild;)e.current.removeChild(e.current.firstChild)}();try{var t;l=new v.xsS,d=new v.SUY,c=new E._,m=new N.k,(s=new v.CP7).setPixelRatio(window.devicePixelRatio),s.setSize(i,r),s.setClearColor(16777215,1),s.shadowMap.enabled=!0,null===(t=e.current)||void 0===t||t.appendChild(s.domElement),h=new v.cPb(45,i/r,.1,100),l.add(new v.Mig(16777215,2.2)),(p=new v.Ox3(16769721,2)).position.set(2,4,2),p.castShadow=!0,l.add(p),(u=new v.Kj0(new v._12(10,10,1,1),new v.Tn7({opacity:.2}))).rotation.x=-Math.PI/2,u.receiveShadow=!0,l.add(u),l.add(new v.VLJ(10,20,0,10066329)),l.add(new v.y8_(10)),(g=new A.z(h,s.domElement)).enableDamping=!0,await j()(),await C(),await M()}catch(e){alert("error occurred!");return}finally{n(!1)}O()}async function C(){return new Promise((e,t)=>{let n=P[f];if(o[n.name])return e();m.load(n.path,t=>{t.castShadow=!0;let a=new v.ZzF().setFromObject(t);t.scale.multiplyScalar(n.height/a.max.y),t.material.forEach(e=>{e.emissive.multiplyScalar(n.emissiveMag)}),o[n.name]=t,e()},e=>console.info("[model] ".concat(e.loaded/e.total*100,"% loaded")),e=>t(e))})}async function M(){return new Promise((e,t)=>{var n;let a=P[f],i=F[y];n=o[a.name],w=_.d9(n),m.loadAnimation(i.path,w,n=>{if(c.meshes.length)return e();try{c.add(w,{animation:n,physics:!0})}catch(e){console.error(e),t(e);return}l.add(w),g.target.set(0,a.height/2,0),g.object.position.set(0,.55*a.height,1.9*a.height),e()},e=>console.info("[motion] ".concat(e.loaded/e.total*100,"% loaded")),e=>t(e))})}function O(){let e=()=>{c.update(d.getDelta()),g.update(),s.render(l,h),a=requestAnimationFrame(e)};e()}async function z(){f=(f+1)%P.length,T()}async function R(){y=(y+1)%F.length,T()}async function T(){n(!0),c.remove(w),l.remove(w),cancelAnimationFrame(a);try{await C(),await M()}catch(e){k();return}finally{n(!1)}O()}return(0,x.useEffect)(()=>{i=window.innerWidth,r=window.innerHeight,o||(o={}),f||(f=0),y||(y=Math.floor(Math.random()*F.length)),k()},[]),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(S,{title:"tic40/threejs-mmd",description:"tic40/threejs-mmd"}),(0,b.jsx)("div",{className:"absolute top-1/2 left-1/2 animate-ping h-5 w-5 bg-gray-600 rounded-full",role:"status",style:{display:t?"block":"none"}}),(0,b.jsx)("button",{onClick:z,className:"absolute top-2 left-2 bg-transparent hover:text-gray-500 text-gray-700 py-1 px-1 border rounded",disabled:t,children:"Model >>"}),(0,b.jsx)("button",{onClick:R,className:"absolute top-2 left-24 bg-transparent hover:text-gray-500 text-gray-700 py-1 px-1 border rounded",disabled:t,children:"Motion >>"}),(0,b.jsx)("a",{className:"absolute bottom-2 left-2 bg-transparent text-gray-700 py-1 px-1 noborder rounded",href:"https://github.com/tic40/threejs-mmd",target:"_blank",rel:"noreferrer",children:"GitHub"}),(0,b.jsx)("div",{ref:e})]})}},5541:function(){}},function(e){e.O(0,[112,935,374,888,774,179],function(){return e(e.s=7084)}),_N_E=e.O()}]);