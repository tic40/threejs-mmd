(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(264)}])},264:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return R}});var r,a,o,i,c,s,u,l,d,p,m,h,f,w,v,g,x=n(7568),y=n(4051),b=n.n(y),k=n(5893),_=n(7294),j=n(9477),C=n(2274),M=n(5414),S=n.n(M),E=n(9008),N=n.n(E),P=function(e){var t=e.title,n=e.description;return(0,k.jsxs)(N(),{children:[(0,k.jsx)("title",{children:t}),(0,k.jsx)("meta",{property:"description",content:n}),(0,k.jsx)("meta",{property:"og:title",content:t}),(0,k.jsx)("meta",{property:"og:description",content:n}),(0,k.jsx)("meta",{property:"og:image",content:"https://avatars.githubusercontent.com/u/739402?v=4?s=400"}),(0,k.jsx)("meta",{name:"twitter:card",content:"summary"}),(0,k.jsx)("link",{rel:"icon",href:"".concat("/threejs-mmd/","/favicon.ico")})]})},Z=n(2125),F=n(410),A=[{name:"lat_miku",path:"./models/lat_miku/Lat\u5f0f\u30df\u30afVer2.31_White.pmd",height:1.58,emissiveMag:1.5},{name:"alicia",path:"./models/alicia/Alicia_solid.pmx",height:1.48,emissiveMag:.1}],O=[{name:"bonyari",path:"./motions/bonyari.vmd"},{name:"gokigen",path:"./motions/gokigen.vmd"},{name:"atamawokaku",path:"./motions/atamawokaku.vmd"},{name:"nekomimi_switch",path:"./motions/nekomimi_lat.vmd"},{name:"schrodingeiger_no_koneko",path:"./motions/Schrodingeiger_no_Koneko1.vmd"}],z=n(9365),R=function(){var e=function(){for(var e;null===(e=N.current)||void 0===e?void 0:e.firstChild;)N.current.removeChild(N.current.firstChild)},t=function(e){return C.d9(e)},n=function(){return A[v]},y=function(){return O[g]},M=function(){var e;s=new j.xsS,u=new j.SUY,l=new Z._,d=new F.k,(c=new j.CP7).setPixelRatio(window.devicePixelRatio),c.setSize(o,i),c.setClearColor(16777215,1),c.shadowMap.enabled=!0,null===(e=N.current)||void 0===e||e.appendChild(c.domElement),p=new j.cPb(45,o/i,.1,100),s.add(new j.Mig(16777215,.6)),(h=new j.Ox3(16769721,.4)).position.set(2,4,2),h.castShadow=!0,s.add(h),(m=new j.Kj0(new j._12(10,10,1,1),new j.Tn7({opacity:.2}))).rotation.x=-Math.PI/2,m.receiveShadow=!0,s.add(m),s.add(new j.VLJ(10,20,0,10066329)),s.add(new j.y8_(10)),(f=new z.z(p,c.domElement)).enableDamping=!0},E=function(){var e=function(){l.update(u.getDelta()),f.update(),c.render(s,p),r=requestAnimationFrame(e)};e()},N=(0,_.useRef)(null),R=(0,_.useState)(!1),T=R[0],D=R[1];function H(){return K.apply(this,arguments)}function K(){return(K=(0,x.Z)(b().mark((function t(){return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return D(!0),e(),t.prev=2,M(),t.next=6,S()();case 6:return t.next=8,L();case 8:return t.next=10,W();case 10:t.next=16;break;case 12:return t.prev=12,t.t0=t.catch(2),alert("error occurred!"),t.abrupt("return");case 16:return t.prev=16,D(!1),t.finish(16);case 19:E();case 20:case"end":return t.stop()}}),t,null,[[2,12,16,19]])})))).apply(this,arguments)}function L(){return V.apply(this,arguments)}function V(){return(V=(0,x.Z)(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){var n=A[v];if(a[n.name])return e();d.load(n.path,(function(t){t.castShadow=!0;var r=(new j.ZzF).setFromObject(t);t.scale.multiplyScalar(n.height/r.max.y),t.material.forEach((function(e){e.emissive.multiplyScalar(n.emissiveMag)})),a[n.name]=t,e()}),(function(e){return console.info("[model] ".concat(e.loaded/e.total*100,"% loaded"))}),(function(e){return t(e)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(){return X.apply(this,arguments)}function X(){return(X=(0,x.Z)(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var o=n(),i=y();w=t(a[o.name]),d.loadAnimation(i.path,w,(function(t){if(l.meshes.length)return e();try{l.add(w,{animation:t,physics:!0})}catch(n){return console.error(n),void r(n)}s.add(w),f.target.set(0,o.height/2,0),f.object.position.set(0,.55*o.height,1.9*o.height),e()}),(function(e){return console.info("[motion] ".concat(e.loaded/e.total*100,"% loaded"))}),(function(e){return r(e)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(){return(q=(0,x.Z)(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:v=(v+1)%A.length,I();case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(){return(G=(0,x.Z)(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g=(g+1)%O.length,I();case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(){return J.apply(this,arguments)}function J(){return(J=(0,x.Z)(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(!0),l.remove(w),s.remove(w),cancelAnimationFrame(r),e.prev=4,e.next=7,L();case 7:return e.next=9,W();case 9:e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(4),H(),e.abrupt("return");case 15:return e.prev=15,D(!1),e.finish(15);case 18:E();case 19:case"end":return e.stop()}}),e,null,[[4,11,15,18]])})))).apply(this,arguments)}return(0,_.useEffect)((function(){var e;o=window.innerWidth,i=window.innerHeight,a||(a={}),v||(v=0),g||(e=O.length,g=Math.floor(Math.random()*e)),H()}),[]),(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(P,{title:"tic40/threejs-mmd",description:"tic40/threejs-mmd"}),(0,k.jsx)("div",{className:"absolute top-1/2 left-1/2 animate-ping h-5 w-5 bg-gray-600 rounded-full",role:"status",style:{display:T?"block":"none"}}),(0,k.jsx)("button",{onClick:function(){return q.apply(this,arguments)},className:"absolute top-2 left-2 bg-transparent hover:text-gray-500 text-gray-700 py-1 px-1 border rounded",disabled:T,children:"Model >>"}),(0,k.jsx)("button",{onClick:function(){return G.apply(this,arguments)},className:"absolute top-2 left-24 bg-transparent hover:text-gray-500 text-gray-700 py-1 px-1 border rounded",disabled:T,children:"Motion >>"}),(0,k.jsx)("a",{className:"absolute bottom-2 left-2 bg-transparent text-gray-700 py-1 px-1 noborder rounded",href:"https://github.com/tic40/threejs-mmd",target:"_blank",rel:"noreferrer",children:"GitHub"}),(0,k.jsx)("div",{ref:N})]})}},1756:function(){}},function(e){e.O(0,[737,34,92,774,888,179],(function(){return t=8312,e(e.s=t);var t}));var t=e.O();_N_E=t}]);