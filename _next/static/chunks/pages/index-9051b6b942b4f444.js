(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(1906)}])},1906:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return D}});var r,a,o,i,c,s,u,l,d,p,m,h,f,w,v,g,x=n(4051),y=n.n(x),b=n(5893),k=n(7294),_=n(9477),j=n(2274),C=n(5414),P=n.n(C),M=n(9008),S=n.n(M),E=function(t){var e=t.title,n=t.description;return(0,b.jsxs)(S(),{children:[(0,b.jsx)("title",{children:e}),(0,b.jsx)("meta",{property:"description",content:n}),(0,b.jsx)("meta",{property:"og:title",content:e}),(0,b.jsx)("meta",{property:"og:description",content:n}),(0,b.jsx)("meta",{property:"og:image",content:"https://avatars.githubusercontent.com/u/739402?v=4?s=400"}),(0,b.jsx)("meta",{name:"twitter:card",content:"summary"}),(0,b.jsx)("link",{rel:"icon",href:"".concat("/threejs-mmd/","/favicon.ico")})]})},N=n(2125),F=n(410),A=[{name:"lat_miku",path:"./models/lat_miku/Lat\u5f0f\u30df\u30afVer2.31_White.pmd",height:1.58,emissiveMag:1.5},{name:"alicia",path:"./models/alicia/mmd/Alicia_solid.pmx",height:1.48,emissiveMag:.1}],O=[{name:"bonyari",path:"./motions/bonyari.vmd"},{name:"gokigen",path:"./motions/gokigen.vmd"},{name:"atamawokaku",path:"./motions/atamawokaku.vmd"},{name:"nekomimi_switch",path:"./motions/nekomimi_lat.vmd"},{name:"schrodingeiger_no_koneko",path:"./motions/Schrodingeiger_no_Koneko1.vmd"}],z=n(9365);function R(t,e,n,r,a,o,i){try{var c=t[o](i),s=c.value}catch(u){return void n(u)}c.done?e(s):Promise.resolve(s).then(r,a)}function T(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(t){R(o,r,a,i,c,"next",t)}function c(t){R(o,r,a,i,c,"throw",t)}i(void 0)}))}}var D=function(){var t=function(){for(var t;null===(t=S.current)||void 0===t?void 0:t.firstChild;)S.current.removeChild(S.current.firstChild)},e=function(t){return j.d9(t)},n=function(){return A[v]},x=function(){return O[g]},C=function(){var t,e;o=window.innerWidth,i=window.innerHeight,a={},v=1,e=O.length,g=Math.floor(Math.random()*e),s=new _.xsS,u=new _.SUY,l=new N._,d=new F.k,(c=new _.CP7).setPixelRatio(window.devicePixelRatio),c.setSize(o,i),c.setClearColor(16777215,1),c.shadowMap.enabled=!0,null===(t=S.current)||void 0===t||t.appendChild(c.domElement),p=new _.cPb(45,o/i,.1,100),s.add(new _.Mig(16777215,.6)),(h=new _.Ox3(16769721,.4)).position.set(2,4,2),h.castShadow=!0,s.add(h),(m=new _.Kj0(new _._12(10,10,1,1),new _.Tn7({opacity:.2}))).rotation.x=-Math.PI/2,m.receiveShadow=!0,s.add(m),s.add(new _.VLJ(10,20,0,10066329)),s.add(new _.y8_(10)),(f=new z.z(p,c.domElement)).enableDamping=!0},M=function(){var t=function(){l.update(u.getDelta()),f.update(),c.render(s,p),r=requestAnimationFrame(t)};t()},S=(0,k.useRef)(null),R=(0,k.useState)(!1),D=R[0],H=R[1];function K(){return L.apply(this,arguments)}function L(){return(L=T(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return H(!0),t(),C(),e.next=5,P()();case 5:return e.next=7,V();case 7:return e.next=9,X();case 9:M(),H(!1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(){return W.apply(this,arguments)}function W(){return(W=T(y().mark((function t(){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,e){var n=A[v];if(a[n.name])return t();d.load(n.path,(function(e){e.castShadow=!0;var r=(new _.ZzF).setFromObject(e);e.scale.multiplyScalar(n.height/r.max.y),e.material.forEach((function(t){t.emissive.multiplyScalar(n.emissiveMag)})),a[n.name]=e,t()}),(function(t){return console.info("[model] ".concat(t.loaded/t.total*100,"% loaded"))}),(function(t){return e(t)}))})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function X(){return q.apply(this,arguments)}function q(){return(q=T(y().mark((function t(){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){var o=n(),i=x();w=e(a[o.name]),d.loadAnimation(i.path,w,(function(e){if(l.meshes.length)return t();try{l.add(w,{animation:e,physics:!0})}catch(n){console.error(n),r(n)}s.add(w),f.target.set(0,o.height/2,0),f.object.position.set(0,.55*o.height,1.9*o.height),t()}),(function(t){return console.info("[motion] ".concat(t.loaded/t.total*100,"% loaded"))}),(function(t){return r(t)}))})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function G(){return(G=T(y().mark((function t(){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:v=(v+1)%A.length,J();case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function I(){return(I=T(y().mark((function t(){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:g=(g+1)%O.length,J();case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function J(){return U.apply(this,arguments)}function U(){return(U=T(y().mark((function t(){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return H(!0),l.remove(w),s.remove(w),cancelAnimationFrame(r),t.prev=4,t.next=7,V();case 7:return t.next=9,X();case 9:t.next=15;break;case 11:return t.prev=11,t.t0=t.catch(4),K(),t.abrupt("return");case 15:M(),H(!1);case 17:case"end":return t.stop()}}),t,null,[[4,11]])})))).apply(this,arguments)}return(0,k.useEffect)((function(){K()}),[]),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(E,{title:"tic40/threejs-mmd",description:"tic40/threejs-mmd"}),(0,b.jsx)("div",{className:"absolute top-1/2 left-1/2 animate-ping h-5 w-5 bg-gray-600 rounded-full",role:"status",style:{display:D?"block":"none"}}),(0,b.jsx)("button",{onClick:function(){return G.apply(this,arguments)},className:"absolute top-2 left-2 bg-transparent hover:text-gray-500 text-gray-700 py-1 px-1 border rounded",disabled:D,children:"Model >>"}),(0,b.jsx)("button",{onClick:function(){return I.apply(this,arguments)},className:"absolute top-2 left-24 bg-transparent hover:text-gray-500 text-gray-700 py-1 px-1 border rounded",disabled:D,children:"Motion >>"}),(0,b.jsx)("a",{className:"absolute bottom-2 left-2 bg-transparent text-gray-700 py-1 px-1 noborder rounded",href:"https://github.com/tic40/threejs-mmd",target:"_blank",rel:"noreferrer",children:"GitHub"}),(0,b.jsx)("div",{ref:S})]})}},1756:function(){}},function(t){t.O(0,[737,34,472,774,888,179],(function(){return e=8312,t(t.s=e);var e}));var e=t.O();_N_E=e}]);